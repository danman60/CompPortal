# Dual-Agent CADENCE - Quick Start Guide

**Claude (Senior Dev) + Codex (Junior Dev) = Hardened Autonomous Development**

## Setup (One-Time)

### 1. Codex Terminal Window

Open Codex in a terminal with the config loaded:

```bash
cd D:\ClaudeCode\CompPortal
codex --config codex.config.json --sandbox danger-full-access
```

Or double-click: **`start-codex.bat`**

**Leave this terminal open**. When you say "continue", Codex will:
- Check `codex-tasks/` for new `.md` task files
- Generate code following patterns
- Output to `codex-tasks/outputs/[TASK_NAME]_result.md`

### 2. Claude Code Window

Open Claude Code as usual. Claude will:
- Create tasks in `codex-tasks/`
- Check `codex-tasks/outputs/` for Codex results
- Review, integrate, commit, push

---

## Workflow

### Step 1: User Requests Feature

```
User: "Add a studio settings form"
```

### Step 2: Claude Analyzes (Senior Dev)

Claude determines:
- Is this boilerplate? ‚Üí Delegate to Codex
- Is this complex? ‚Üí Handle myself

**For boilerplate (Codex task):**

Claude creates: `codex-tasks/create_studio_settings.md`

```markdown
## Task: Create Studio Settings Form

**File**: src/components/StudioSettingsForm.tsx

**Requirements**:
- React Hook Form + Zod validation
- Fields: studio_name, contact_email, contact_phone, address
- Update mutation via tRPC
- Toast notifications

**Prisma Model**: studios (exact fields listed)
```

Claude says: **"Task created for Codex. Continuing with architecture..."**

Then Claude continues working on complex features in parallel.

### Step 3: Codex Generates (Junior Dev)

Codex (running in terminal):
1. Detects `codex-tasks/create_studio_settings.md`
2. Reads task specification
3. Generates complete component
4. Outputs to `codex-tasks/outputs/create_studio_settings_result.md`

Terminal shows:
```
‚úÖ Task: create_studio_settings.md
‚úÖ Generated: StudioSettingsForm.tsx
‚úÖ Output: codex-tasks/outputs/create_studio_settings_result.md
‚úÖ Log: codex-tasks/logs/create_studio_settings_log.md
```

### Step 4: Claude Reviews & Integrates (Senior Dev)

Claude (autonomously):

```typescript
// 1. Read Codex output
const output = readFile('codex-tasks/outputs/create_studio_settings_result.md')

// 2. Extract and validate code
const code = extractCode(output)

// Quality gates
‚úÖ Prisma fields exact match
‚úÖ TypeScript valid
‚úÖ Glassmorphic pattern
‚úÖ Form validation
‚úÖ Error handling

// 3. Integrate
writeFile('src/components/StudioSettingsForm.tsx', code)

// 4. Build validation
exec('npm run build')
‚úÖ All routes compile

// 5. Commit
exec(`git add .`)
exec(`git commit -m "feat: Add studio settings form

- Form component (StudioSettingsForm.tsx)
- Generated by Codex, integrated by Claude

‚úÖ Build pass.

ü§ñ Claude Code + Codex"`)

// 6. Push
exec('git push origin main')

// 7. Verify deployment
vercel:get_deployments({ limit: 1 })
‚úÖ Deployment: READY
```

Claude reports: **"‚úÖ Studio settings form complete. Committed c3a82f1. Deployed successfully."**

### Step 5: Continue to Next Feature

Claude immediately moves to next feature (no pause).

---

## Parallel Execution Example

**User Request:** "Add studio settings, competition filters, and judge assignment UI"

### Traditional (Sequential - 1 Agent)
```
Claude: Studio settings ‚Üí 20 min
Claude: Competition filters ‚Üí 15 min
Claude: Judge assignment ‚Üí 25 min
Total: 60 minutes
```

### Dual-Agent (Parallel - 2 Agents)
```
Claude: Creates Codex task for studio settings (2 min)
Codex: Generates studio settings (5 min) ‚Üê PARALLEL
Claude: Creates competition filters (15 min) ‚Üê PARALLEL
Claude: Reviews Codex output, integrates (3 min)
Claude: Creates Codex task for judge assignment (2 min)
Codex: Generates judge assignment (5 min) ‚Üê PARALLEL
Claude: Reviews, integrates (3 min)

Total: 25 minutes (58% faster)
Token savings: ~16k (Codex handled 2 boilerplate tasks)
```

---

## Quality Gate Failures

If Codex output fails validation:

**Claude:**
```markdown
‚ö†Ô∏è Quality gate failed: Incorrect Prisma field names

Creating blocker: codex-tasks/blockers/BLOCKER_studio_settings_fields.md

Issue: Used 'name' instead of 'studio_name'
Action: Correcting manually and updating Codex task template

‚úÖ Fixed and integrated
```

After 3 failures ‚Üí Claude disables delegation, handles manually.

---

## Monitoring

### Codex Terminal
```
Codex Junior Dev - CompPortal
Monitoring: codex-tasks/

‚úÖ Task detected: create_studio_settings.md
‚úÖ Generated: 248 lines
‚úÖ Output: codex-tasks/outputs/create_studio_settings_result.md
‚è≥ Waiting for next task...

‚úÖ Task detected: create_judge_assignment.md
‚úÖ Generated: 312 lines
‚úÖ Output: codex-tasks/outputs/create_judge_assignment_result.md
‚è≥ Waiting for next task...
```

### Claude Code
```
Claude: Creating task for Codex: studio_settings
Claude: Continuing with complex feature: scheduling_algorithm
Claude: Reviewing Codex output: studio_settings
Claude: ‚úÖ Quality gates passed. Integrating...
Claude: ‚úÖ Build success. Committing...
Claude: ‚úÖ Pushed c3a82f1. Deployment verified.
Claude: Feature complete. Next: judge_assignment...
```

---

## Stopping

### Stop Codex
In Codex terminal: `Ctrl+C`

### Stop Claude CADENCE
Say: **"STOP"** or **"pause CADENCE"**

Claude will:
1. Complete current atomic task
2. Commit with WIP marker
3. Update PROJECT_STATUS.md with resume point
4. Exit cleanly

---

## Benefits

**Speed:**
- 2-3x faster on multi-feature development
- Parallel execution vs sequential

**Quality:**
- Every Codex output reviewed by Claude
- Mandatory quality gates before integration
- Build validation before every commit

**Token Efficiency:**
- Claude doesn't generate boilerplate: -8k tokens per task
- 30+ sessions before context limit (vs 5-6)

**Git Hygiene:**
- All commits validated and tested
- Proper commit messages
- Deployment verified
- Rollback on failure

---

## Troubleshooting

**Codex not detecting tasks:**
- Check Codex terminal is running
- Verify `codex.config.json` exists
- Ensure task files end with `.md`

**Quality gates failing:**
- Check `codex-tasks/blockers/` for details
- Claude will fix and integrate
- After 3 failures, Claude handles manually

**Build failures:**
- Claude validates before commit
- If build fails, commit is skipped
- Check logs for error details

**Deployment issues:**
- Claude verifies after push
- Auto-rollback on ERROR state
- Check Vercel logs via MCP

---

## Result

**Hardened autonomous development with:**
- Senior dev (Claude) reviewing all code
- Junior dev (Codex) handling boilerplate
- Quality gates enforced
- Git commits validated
- Production verified
- 30+ sessions before context limit

**Start:** Run `start-codex.bat` in terminal, then say "start CADENCE" to Claude.
