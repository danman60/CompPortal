{
  "master": {
    "tasks": [
      {
        "id": "1",
        "title": "Backstage Tech UI - Kiosk Mode Shell",
        "description": "Create the Backstage Tech interface at /backstage with kiosk mode (fullscreen, no navigation). Shows current routine, next 3 upcoming, play/pause/stop controls.",
        "details": "- Route: /backstage - Kiosk mode: F11 fullscreen, hide browser UI - Display: Current routine (entry #, title, studio) - Up Next list: Next 3 routines with durations - Controls: Play, Pause, Stop buttons - Sync status indicator - MP3 download status (X/Y downloaded)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backstage UI - Kiosk Mode",
            "description": "Comprehensive tests for Backstage Tech interface",
            "details": "UNIT TESTS:\n- Kiosk mode activates on F11/fullscreen button\n- Browser navigation hidden when kiosk active\n- Current routine displays correct entry #, title, studio\n- Up Next list shows exactly 3 routines\n- Play/Pause/Stop buttons render correctly\n- Sync status indicator shows connected/disconnected\n- MP3 download status shows X/Y format\n\nINTEGRATION TESTS:\n- Route /backstage loads without auth redirect\n- Component receives lineup data from getLineup API\n- Play button triggers MP3 player component\n- Sync status updates when WebSocket connects/disconnects\n\nE2E TESTS (Playwright):\n- Navigate to /backstage, verify kiosk layout\n- Verify no browser back/forward buttons visible\n- Click Play, verify audio starts\n- Disconnect network, verify \"Disconnected\" indicator\n- Reconnect, verify sync restores",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 1,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T05:26:52.156Z"
      },
      {
        "id": "2",
        "title": "MP3 Player Component - Web Audio API",
        "description": "Build MP3 player using Web Audio API. Extract duration from actual MP3 file. Real-time countdown display. Plugs into Backstage UI.",
        "details": "- Use Web Audio API for playback - Extract duration from MP3 metadata/decode - Real-time progress bar with countdown - Events: onPlay, onPause, onStop, onEnd - Broadcast current time to other views via sync",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: MP3 Player Component",
            "description": "Comprehensive tests for Web Audio API player",
            "details": "UNIT TESTS:\n- Player initializes with Web Audio API context\n- Duration extracted from MP3 file matches actual length\n- Play() starts audio playback\n- Pause() pauses at current position\n- Stop() resets to beginning\n- Progress bar updates every 100ms\n- Countdown displays remaining time correctly\n- onPlay/onPause/onStop/onEnd events fire correctly\n\nINTEGRATION TESTS:\n- Player receives MP3 blob from IndexedDB\n- Current time broadcasts to sync infrastructure\n- Multiple players on different devices show same time (±250ms)\n\nE2E TESTS (Playwright):\n- Load MP3, verify duration displays\n- Play, verify progress bar moves\n- Pause at 30s, verify position holds\n- Stop, verify resets to 0:00\n- Play to end, verify onEnd fires\n\nEDGE CASES:\n- Test with 10-second MP3 (short)\n- Test with 5-minute MP3 (long)\n- Test with corrupted MP3 (should fail gracefully)\n- Test rapid play/pause/play sequence",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 2,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T05:34:09.548Z"
      },
      {
        "id": "3",
        "title": "MP3 Download Manager - Offline Storage",
        "description": "Bulk download all competition MP3s to IndexedDB for offline playback. Progress indicator. Last-minute loader for day-of submissions.",
        "details": "- Download from Supabase bucket to IndexedDB - Progress: X/Y files downloaded - Pre-scan for corrupted MP3s - Last-minute loader for day-of song uploads - Storage: ~6000 files capacity needed",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: MP3 Download Manager",
            "description": "Comprehensive tests for offline MP3 storage",
            "details": "UNIT TESTS:\n- Download manager initializes IndexedDB store\n- Single file downloads and stores correctly\n- Progress callback fires with X/Y count\n- File retrieval returns correct blob\n- Delete file removes from IndexedDB\n- Storage quota check returns available space\n\nINTEGRATION TESTS:\n- Bulk download 10 files from Supabase bucket\n- Progress bar updates during bulk download\n- Cancel mid-download stops remaining files\n- Resume download after page refresh\n- Last-minute loader adds single file to existing set\n\nE2E TESTS (Playwright):\n- Navigate to download manager UI\n- Start bulk download, verify progress\n- Go offline during download, verify resume\n- Verify downloaded files play correctly\n\nSTRESS TESTS:\n- Download 100 files sequentially\n- Download 100 files in parallel (5 concurrent)\n- Storage with 500MB of MP3s\n- IndexedDB performance with 1000 entries\n\nEDGE CASES:\n- Network timeout during download\n- Supabase bucket 404 error\n- Disk full scenario\n- Duplicate file download (should skip)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 3,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T05:44:23.197Z"
      },
      {
        "id": "4",
        "title": "CD Control Panel - Main Interface",
        "description": "Competition Director control panel at /dashboard/director-panel/live. Three-panel layout: routine list, current routine center stage, status panel.",
        "details": "- Route: /dashboard/director-panel/live - Left: Routine list with current/next/on-deck - Center: Current routine details + time remaining - Right: Judge status panel - Bottom: Controls (Back, Stop, Next, Add Break) - Schedule delay indicator (+X min behind)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: CD Control Panel Main Interface",
            "description": "Comprehensive tests for Competition Director control panel",
            "details": "UNIT TESTS:\n- Three-panel layout renders (left/center/right)\n- Routine list shows entries in order\n- Current routine highlighted in list\n- Center panel shows routine details\n- Time remaining countdown displays\n- Judge status panel shows all judges\n- Controls: Back/Stop/Next/Break buttons render\n- Schedule delay indicator shows +X min format\n\nINTEGRATION TESTS:\n- getLineup API populates routine list\n- getJudges API populates judge status\n- getRoutineScores API shows running scores\n- startCompetition mutation changes state\n- Click Next advances current routine\n\nE2E TESTS (Playwright):\n- Login as CD, navigate to /dashboard/director-panel/live\n- Verify all panels render\n- Click Start Competition, verify state changes\n- Verify judge scores appear in real-time\n- Click Next, verify routine advances\n- Click Stop, verify competition pauses\n\nRESPONSIVE TESTS:\n- Test on 1920px desktop\n- Test on 1024px tablet\n- Verify all controls accessible on touch",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 4,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T06:11:06.027Z"
      },
      {
        "id": "5",
        "title": "CD Control Panel - Routine Reordering",
        "description": "Allow CD to drag/reorder routines with confirmation dialog. Entry numbers stay locked, only time slots change.",
        "details": "- Drag-drop reorder in routine list - Confirmation: \"Are you sure?\" + click to confirm - Entry number stays same (111 stays 111) - Time slots recalculate - Can move routine to different day",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "4"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: CD Routine Reordering",
            "description": "Comprehensive tests for drag-drop reorder with locked entry numbers",
            "details": "UNIT TESTS:\n- Drag handle renders on each routine\n- Drag start sets dragging state\n- Drop target highlights on hover\n- Confirmation dialog appears on drop\n- Cancel returns routine to original position\n- Confirm updates routine order\n- Entry numbers unchanged after reorder\n- Time slots recalculate after reorder\n\nINTEGRATION TESTS:\n- Reorder mutation updates database\n- Other devices see new order via sync\n- Undo restores previous order\n\nE2E TESTS (Playwright):\n- Drag routine #112 above #111\n- Verify confirmation \"Are you sure?\"\n- Click Confirm\n- Verify #112 now first in list\n- Verify entry #112 still shows \"112\" (not \"111\")\n- Verify time slots recalculated\n\nEDGE CASES:\n- Reorder during active playback\n- Reorder completed routine (should block)\n- Reorder to different day\n- Rapid reorder (drag during drag)\n- Reorder with 500 routines (performance)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 5,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T08:43:40.367Z"
      },
      {
        "id": "6",
        "title": "CD Control Panel - Break Management",
        "description": "Handle judge break requests (2/5/10 min) and CD emergency breaks. Update all subsequent routine times when break inserted.",
        "details": "- Display incoming break requests from judges - Approve/Deny buttons for CD - Emergency break insertion anywhere in schedule - Cascade time updates to all subsequent routines - CD can end break early to recover time",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "4"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: CD Break Management",
            "description": "Comprehensive tests for break requests and emergency breaks",
            "details": "UNIT TESTS:\n- Break request card renders with judge name, duration\n- Approve button triggers approval mutation\n- Deny button triggers denial mutation\n- Emergency break button opens duration picker\n- Break countdown timer displays correctly\n- \"End Break Early\" button appears during break\n- Time cascade recalculates all subsequent routines\n\nINTEGRATION TESTS:\n- Judge break request appears on CD panel in <1s\n- Approval notification sent back to judge\n- Emergency break inserts into schedule\n- All routine times update after break added\n- Schedule delay indicator updates (+X min)\n\nE2E TESTS (Playwright):\n- Judge requests 5 min break\n- CD sees request appear\n- CD clicks Approve\n- Verify break countdown starts\n- CD clicks \"End Early\" at 2 min\n- Verify schedule times updated\n\nEDGE CASES:\n- Multiple simultaneous break requests\n- Break request during break (should queue)\n- Emergency break during active routine\n- Deny all requests, verify no time change\n- 30-minute emergency break (max duration)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 6,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T08:51:07.147Z"
      },
      {
        "id": "7",
        "title": "Judge Tablet UI - Scoring Interface",
        "description": "Judge scoring interface at /judge. Slider 60-100, award level display, comments field, submit button. Authenticated per judge.",
        "details": "- Route: /judge (authenticated) - Current routine display (entry #, title, studio, category) - Score slider: 60-100 range - Award level auto-displays based on score - Comments text field - Special awards: type nomination on device - Submit button (locks score, only CD can edit after)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Judge Scoring Interface",
            "description": "Comprehensive tests for judge tablet scoring UI",
            "details": "UNIT TESTS:\n- Score slider renders with 60-100 range\n- Slider thumb moves on drag/touch\n- Award level updates based on score value\n- Comments textarea accepts input\n- Special awards text field renders\n- Submit button disabled until score set\n- Submit button enables after score set\n- After submit, slider becomes read-only\n\nINTEGRATION TESTS:\n- /judge route requires authentication\n- Current routine fetched from getLineup\n- submitScore mutation saves to database\n- Score appears on CD panel after submit\n- Judge sees own score after refresh\n\nE2E TESTS (Playwright):\n- Login as Judge 1\n- Navigate to /judge\n- Verify current routine displays\n- Drag slider to 85\n- Verify award level shows \"HIGH GOLD\"\n- Type comment \"Great performance\"\n- Type special award nomination\n- Click Submit\n- Verify slider now read-only\n- Login as CD, verify score 85 appears\n\nEDGE CASES:\n- Submit without comment (allowed)\n- Submit at exactly 60 (minimum)\n- Submit at exactly 100 (maximum)\n- Double-click submit (should not duplicate)\n- Network offline during submit (should cache)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 7,
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "SPEC UPDATE: Score format XX.XX (00.00-99.99)",
            "description": "Per client feedback: Score format is XX.XX (two decimals ALWAYS). Input: BOTH slider AND manual typing. Range: 00.00-99.99. Valid: 89.06, 42.67. Invalid: 69, 72, 86.6. This SUPERSEDES '60-100 slider' in parent task.",
            "details": "",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 7,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T05:49:33.225Z"
      },
      {
        "id": "8",
        "title": "Judge Tablet UI - Break Request Buttons",
        "description": "Add break request buttons to judge interface. [2 min] [5 min] [10 min] sends request to CD.",
        "details": "- Three buttons: 2 min, 5 min, 10 min - Request sent to CD control panel - Visual confirmation request was sent - CD approval/denial reflected back to judge",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "7"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Judge Break Request Buttons",
            "description": "Comprehensive tests for break request UI on judge tablet",
            "details": "UNIT TESTS:\n- Three buttons render: 2 min, 5 min, 10 min\n- Button click triggers break request mutation\n- Visual feedback on click (loading state)\n- Success toast shows \"Request sent\"\n- Pending state shows \"Awaiting CD approval\"\n- Approved state shows \"Break approved\"\n- Denied state shows \"Break denied\"\n\nINTEGRATION TESTS:\n- Request reaches CD panel within 1s\n- CD approval updates judge UI\n- CD denial updates judge UI\n- Multiple judges can request simultaneously\n\nE2E TESTS (Playwright):\n- Login as Judge 2\n- Click [5 min] button\n- Verify \"Request sent\" feedback\n- Login as CD, verify request appears\n- CD clicks Approve\n- Back to Judge 2, verify \"Break approved\"\n\nEDGE CASES:\n- Request while previous pending (should queue or block)\n- Request during active break (should block)\n- Network offline (should show error)\n- Rapid button clicks (debounce)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 8,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T08:55:47.908Z"
      },
      {
        "id": "9",
        "title": "Live Scoreboard Display",
        "description": "Public scoreboard at /scoreboard/:competitionId showing real-time scores, award levels, category placements, schedule status.",
        "details": "- Route: /scoreboard/:competitionId (public) - Real-time score updates - Award level distribution - Category placements/rankings - Running schedule status (ahead/behind) - Auto-refresh display",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Live Scoreboard Display",
            "description": "Comprehensive tests for public scoreboard",
            "details": "UNIT TESTS:\n- Scoreboard renders without authentication\n- Score table shows routine, studio, score, award\n- Award level badges display correct colors\n- Category filter dropdown works\n- Placement column shows 1st, 2nd, 3rd...\n- Schedule status shows +/- minutes\n- Auto-refresh indicator visible\n\nINTEGRATION TESTS:\n- getStandings API populates table\n- New score appears within 2s of submission\n- Category filter fetches filtered results\n- Real-time updates via WebSocket/polling\n\nE2E TESTS (Playwright):\n- Navigate to /scoreboard/:competitionId\n- Verify scores display\n- Submit new score as Judge\n- Verify scoreboard updates within 3s\n- Filter by category \"Junior Jazz\"\n- Verify only Junior Jazz shows\n\nDISPLAY TESTS:\n- Test on 1080p TV resolution\n- Test on 4K display\n- Verify readable from 10 feet away\n- Dark mode / high contrast option\n\nEDGE CASES:\n- Scoreboard with 0 completed routines\n- Scoreboard with 500 completed routines\n- Tie scores (same placement?)\n- Score update during page load",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 9,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T08:18:10.770Z"
      },
      {
        "id": "10",
        "title": "LAN Sync Infrastructure",
        "description": "Real-time sync between all devices on local network. 250ms latency target. Broadcast current routine, scores, time remaining.",
        "details": "- WebSocket or similar for LAN sync - Broadcast: current routine, playback time, scores - All devices see same state within 250ms - Handle device reconnection gracefully - Works without internet (LAN only)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: LAN Sync Infrastructure",
            "description": "Comprehensive tests for real-time device synchronization",
            "details": "UNIT TESTS:\n- WebSocket connection establishes\n- Heartbeat keeps connection alive\n- Reconnect after disconnect\n- Message queue during offline\n- Broadcast sends to all subscribers\n- Subscribe filters by competition ID\n\nINTEGRATION TESTS:\n- CD action broadcasts to all devices\n- Judge score appears on CD within 250ms\n- Backstage playback time syncs to CD\n- 5 devices stay synchronized\n- State converges after network partition\n\nE2E TESTS (Playwright - Multi-Device):\n- Open CD panel in Tab 1\n- Open Backstage in Tab 2\n- Open Judge in Tab 3\n- CD clicks Next routine\n- Verify all 3 tabs show same routine within 500ms\n- Backstage plays music\n- Verify CD and Judge show same time remaining\n\nLATENCY TESTS:\n- Measure sync latency (target <250ms)\n- Test with 10 simultaneous clients\n- Test with simulated network lag (100ms, 500ms)\n\nOFFLINE TESTS:\n- Disconnect device, queue actions\n- Reconnect, verify sync catches up\n- Conflict resolution (2 devices edit same data)\n\nEDGE CASES:\n- Device joins mid-competition\n- Device battery dies, rejoins\n- Router restart (all disconnect, all reconnect)\n- Competition spans 2 days (persistent connection?)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 10,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T05:18:36.556Z"
      },
      {
        "id": "11",
        "title": "Offline Score Caching",
        "description": "Cache judge scores locally in IndexedDB. Auto-sync to server when connection restored. Scores must never be lost.",
        "details": "- Save scores to IndexedDB immediately on submit - Queue for server sync when offline - Auto-sync when connection restored - Visual indicator: synced vs pending - Scores persist across app restart",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "7",
          "10"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Offline Score Caching",
            "description": "Comprehensive tests for IndexedDB score persistence",
            "details": "UNIT TESTS:\n- Score saves to IndexedDB on submit\n- Pending indicator shows for unsynced scores\n- Synced indicator shows after server confirm\n- Queue manager tracks pending items\n- Auto-sync triggers on reconnect\n- Manual sync button forces upload\n\nINTEGRATION TESTS:\n- Submit score offline, verify in IndexedDB\n- Come online, verify syncs to server\n- Server confirms, verify local status updates\n- Multiple offline scores sync in order\n\nE2E TESTS (Playwright):\n- Login as Judge\n- Disconnect network (DevTools)\n- Submit score 82\n- Verify \"Pending sync\" indicator\n- Submit second score 88\n- Reconnect network\n- Verify both scores sync\n- Check CD panel shows both scores\n\nDATA INTEGRITY TESTS:\n- Submit 100 scores offline, reconnect, verify all sync\n- App crash mid-sync, verify resume on restart\n- Duplicate score prevention (same routine/judge)\n- Conflict: offline edit vs server edit\n\nEDGE CASES:\n- IndexedDB full (unlikely but handle)\n- Browser cleared storage while offline\n- Sync during competition end\n- Score submitted, then routine scratched",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 11,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T08:03:15.256Z"
      },
      {
        "id": "12",
        "title": "Update Backend - Score Range 60-100",
        "description": "Update liveCompetition.ts submitScore to validate 60-100 range instead of 0-10. Update calculateScore award level logic.",
        "details": "- submitScore: change z.number().min(0).max(10) to min(60).max(100) - calculateScore: update award level thresholds - Use scoring_ranges from competition settings - Ensure backwards compatibility",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend Score Range 60-100",
            "description": "Comprehensive tests for updated score validation",
            "details": "UNIT TESTS:\n- submitScore rejects score < 60\n- submitScore rejects score > 100\n- submitScore accepts score = 60 (boundary)\n- submitScore accepts score = 100 (boundary)\n- submitScore accepts score = 80 (middle)\n- calculateScore uses competition scoring_ranges\n- Award levels map correctly to ranges\n\nINTEGRATION TESTS:\n- Submit 60, verify stored as 60\n- Submit 100, verify stored as 100\n- Submit 59, verify 400 error\n- Submit 101, verify 400 error\n- Submit 85.5, verify decimal accepted\n\nAPI TESTS:\n- POST /submitScore with score: 75 -> 200 OK\n- POST /submitScore with score: 50 -> 400 BAD REQUEST\n- POST /submitScore with score: \"abc\" -> 400 BAD REQUEST\n- calculateScore returns correct award level\n\nMIGRATION TESTS:\n- Existing scores (0-10 range) still query correctly\n- New scores (60-100) store correctly\n- Mixed data doesn't break getStandings\n\nEDGE CASES:\n- Float scores: 85.7 -> rounds or truncates?\n- Score exactly on threshold boundary\n- Custom scoring_ranges from competition settings",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 12,
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "SPEC UPDATE: Score range 00.00-99.99 (not 60-100)",
            "description": "Per client feedback: Score range is 00.00-99.99 with XX.XX format. Validation: z.number().min(0).max(99.99) with 2 decimal places. This SUPERSEDES '60-100' in parent task description.",
            "details": "",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 12,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T08:23:21.465Z"
      },
      {
        "id": "13",
        "title": "CD Score Editing",
        "description": "Allow CD to edit any score after judge submits. Judge can only edit before submit, CD can edit anytime.",
        "details": "- CD sees all scores in control panel - Edit button on each score - Modal to adjust score value - Audit log of score changes - Original score preserved in history",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "4",
          "12"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: CD Score Editing",
            "description": "Comprehensive tests for CD post-submission score edits",
            "details": "UNIT TESTS:\n- Edit button appears on each score row\n- Edit modal opens with current score pre-filled\n- Score slider in modal has 60-100 range\n- Save button updates score\n- Cancel button closes without change\n- Audit log entry created on edit\n- Original score preserved in history\n\nINTEGRATION TESTS:\n- CD edits score, verify database updated\n- Edited score broadcasts to all devices\n- Judge sees updated score (read-only)\n- Scoreboard reflects new score\n- calculateScore re-runs after edit\n\nE2E TESTS (Playwright):\n- Judge submits score 75\n- Login as CD\n- Click Edit on Judge 1's score\n- Change 75 to 82\n- Click Save\n- Verify score shows 82\n- Check audit log shows \"75 -> 82 by CD\"\n- Verify scoreboard updated\n\nAUTHORIZATION TESTS:\n- Judge cannot edit after submit (button hidden)\n- Judge cannot edit other judge's score\n- CD can edit any score\n- Non-CD role cannot access edit\n\nEDGE CASES:\n- Edit during offline (queue for sync)\n- Edit score multiple times\n- Edit to same value (no-op?)\n- Edit deleted/scratched routine score",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 13,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T09:36:21.969Z"
      },
      {
        "id": "14",
        "title": "State Persistence Across Days",
        "description": "Competition state persists across days. Close app Saturday night, resume Sunday morning at same point.",
        "details": "- Save current routine index to IndexedDB - Save all scores and state per competition - On app open: restore last state - Handle day transitions (Saturday → Sunday) - Clear state only when competition ends",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "10",
          "11"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: State Persistence Across Days",
            "description": "Comprehensive tests for multi-day competition state",
            "details": "UNIT TESTS:\n- Current routine index saves to IndexedDB\n- All scores persist in IndexedDB\n- Competition state (active/paused) persists\n- Schedule delay persists\n- Break state persists\n- Last sync timestamp persists\n\nINTEGRATION TESTS:\n- Close browser, reopen, verify same state\n- Day 1 ends at routine 50, Day 2 starts at 51\n- Scores from Day 1 visible on Day 2\n- Schedule delay carries over\n\nE2E TESTS (Playwright):\n- Start competition, score 10 routines\n- Close all browser tabs\n- Wait 5 seconds\n- Reopen /dashboard/director-panel/live\n- Verify current routine is #11\n- Verify 10 scores still visible\n- Continue competition\n\nPERSISTENCE TESTS:\n- Browser restart\n- Device restart\n- Clear browser cache (should warn user!)\n- Multiple competitions (isolated state)\n\nDAY TRANSITION TESTS:\n- End Day 1 with \"End Day\" button\n- Verify Day 2 schedule loads\n- Routines from Day 2 now current\n- Day 1 routines marked complete\n\nEDGE CASES:\n- Competition spans 3+ days\n- Competition deleted mid-event\n- Move routine from Day 2 to Day 1 after Day 1 complete\n- Time zone change (DST)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 14,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T09:42:37.177Z"
      },
      {
        "id": "15",
        "title": "MP3 Pre-Scan for Corrupted Files",
        "description": "Scan all downloaded MP3s before competition starts. Flag corrupted files. Never skip - pause and alert CD if problem found.",
        "details": "- Scan all MP3s in IndexedDB - Attempt to decode each file - Flag files that fail decode - Report to CD before competition starts - If corrupted during playback: pause, alert CD",
        "testStrategy": "",
        "status": "in-progress",
        "dependencies": [
          "3"
        ],
        "priority": "low",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: MP3 Pre-Scan for Corrupted Files",
            "description": "Comprehensive tests for MP3 validation before competition",
            "details": "UNIT TESTS:\n- Scanner iterates all MP3s in IndexedDB\n- Decode attempt on each file\n- Valid file passes check\n- Corrupted file fails check\n- Truncated file fails check\n- Wrong format (wav renamed to mp3) fails\n- Progress callback fires per file\n- Results summary shows pass/fail counts\n\nINTEGRATION TESTS:\n- Scan 100 MP3s, report results\n- Flag corrupted files with visual indicator\n- Allow re-download of flagged files\n- Verify re-downloaded file passes\n\nE2E TESTS (Playwright):\n- Download 10 test MP3s (1 corrupted)\n- Click \"Pre-Scan\" button\n- Verify progress bar\n- Verify 9 pass, 1 fail\n- Verify corrupted file highlighted\n- Click \"Re-download\" on corrupted\n- Re-scan, verify all pass\n\nPLAYBACK FAILURE TESTS:\n- Attempt play corrupted file\n- Verify pause (not skip)\n- Verify CD alert appears\n- CD can skip or wait for fix\n\nEDGE CASES:\n- 0 byte file\n- Very large file (100MB+)\n- Encrypted/DRM MP3 (should fail)\n- Partially downloaded file\n- Network error during scan\n- Scan cancelled mid-way",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 15,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T09:42:52.749Z"
      },
      {
        "id": "16",
        "title": "Database Migration - Live Competition State Tables",
        "description": "Create new tables for live competition state: live_competition_state, break_requests, schedule_breaks, score_audit_log",
        "details": "CREATE TABLE live_competition_state:\n- competition_id (FK)\n- current_routine_id (FK, nullable)\n- current_routine_index (int)\n- competition_status (enum: not_started, active, paused, break, completed)\n- schedule_delay_minutes (int, default 0)\n- started_at, paused_at timestamps\n- tenant_id (FK)\n\nCREATE TABLE break_requests:\n- id, tenant_id, competition_id\n- judge_id (FK)\n- duration_minutes (2, 5, or 10)\n- status (enum: pending, approved, denied)\n- requested_at, responded_at\n- responded_by (FK to users)\n\nCREATE TABLE schedule_breaks:\n- id, tenant_id, competition_id\n- break_type (enum: judge_request, emergency)\n- duration_minutes\n- inserted_after_routine_id\n- started_at, ended_at\n- created_by (FK)\n\nCREATE TABLE score_audit_log:\n- id, tenant_id\n- score_id (FK)\n- old_value, new_value\n- changed_by (FK)\n- changed_at\n- reason (optional text)\n\nAlso add to competition_entries:\n- mp3_url (text, nullable)\n- mp3_duration_seconds (int, nullable)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Database Migration - Live State Tables",
            "description": "Comprehensive tests for new database tables",
            "details": "MIGRATION TESTS:\n- Migration runs without errors\n- All tables created with correct columns\n- Foreign keys properly constrained\n- Indexes created for query performance\n- Enums created (competition_status, break_type, break_status)\n\nSCHEMA TESTS:\n- live_competition_state: one row per competition\n- break_requests: FK to judges, competitions\n- schedule_breaks: FK to routines, users\n- score_audit_log: FK to scores, users\n- competition_entries new columns nullable\n\nROLLBACK TESTS:\n- Migration can be rolled back cleanly\n- No data loss on rollback\n- Re-run migration after rollback succeeds\n\nDATA INTEGRITY:\n- Insert test data into each table\n- Verify constraints prevent bad data\n- Cascade delete behavior correct\n- tenant_id isolation enforced",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 16,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T04:58:35.652Z"
      },
      {
        "id": "17",
        "title": "Backend API - Break Request System",
        "description": "Add tRPC endpoints for judge break requests: requestBreak, getBreakRequests, approveBreak, denyBreak",
        "details": "requestBreak mutation:\n- Input: competitionId, judgeId, durationMinutes (2|5|10)\n- Creates break_requests record with status=pending\n- Returns requestId\n\ngetBreakRequests query:\n- Input: competitionId\n- Returns all pending break requests with judge info\n- CD only\n\napproveBreak mutation:\n- Input: requestId\n- Updates status to approved\n- Creates schedule_breaks record\n- Updates schedule_delay_minutes\n- Returns updated break info\n\ndenyBreak mutation:\n- Input: requestId, reason (optional)\n- Updates status to denied\n- Returns confirmation",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Break Request System",
            "description": "Comprehensive tests for break request endpoints",
            "details": "UNIT TESTS:\n- requestBreak creates record with status=pending\n- requestBreak validates duration (2, 5, 10 only)\n- requestBreak rejects invalid judgeId\n- getBreakRequests returns only pending requests\n- approveBreak updates status to approved\n- approveBreak creates schedule_breaks record\n- denyBreak updates status to denied\n\nAPI TESTS:\n- POST requestBreak with duration=5 → 200\n- POST requestBreak with duration=7 → 400 (invalid)\n- GET getBreakRequests as CD → list of pending\n- GET getBreakRequests as Judge → 403 (forbidden)\n- POST approveBreak → 200, schedule updated\n- POST denyBreak → 200, no schedule change\n\nINTEGRATION TESTS:\n- Judge requests → CD sees in list → CD approves → schedule delays\n- Multiple judges request → queue properly ordered\n- Approve one, deny another → correct state\n\nEDGE CASES:\n- Request when previous still pending\n- Approve request that was already denied\n- Request during active break",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 17,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T06:27:04.459Z"
      },
      {
        "id": "18",
        "title": "Backend API - Emergency Break & End Early",
        "description": "Add tRPC endpoints for CD emergency breaks: addEmergencyBreak, endBreakEarly, getActiveBreak",
        "details": "addEmergencyBreak mutation:\n- Input: competitionId, durationMinutes, insertAfterRoutineId (optional)\n- Creates schedule_breaks with type=emergency\n- Updates live_competition_state.status to 'break'\n- Cascades schedule_delay_minutes\n- Returns breakId, new delay\n\nendBreakEarly mutation:\n- Input: breakId\n- Sets ended_at to now\n- Calculates actual duration\n- Updates schedule_delay_minutes (may recover time)\n- Sets competition status back to 'active'\n- Returns time saved\n\ngetActiveBreak query:\n- Input: competitionId\n- Returns current break info if any (type, duration, time remaining)\n- Returns null if no active break",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Emergency Break",
            "description": "Comprehensive tests for emergency break endpoints",
            "details": "UNIT TESTS:\n- addEmergencyBreak creates schedule_breaks with type=emergency\n- addEmergencyBreak updates competition status to 'break'\n- addEmergencyBreak calculates delay correctly\n- endBreakEarly sets ended_at to now\n- endBreakEarly calculates time saved\n- endBreakEarly updates status back to 'active'\n- getActiveBreak returns current break or null\n\nAPI TESTS:\n- POST addEmergencyBreak with 10 min → 200\n- POST addEmergencyBreak as Judge → 403 (CD only)\n- POST endBreakEarly → 200, time recovered\n- GET getActiveBreak during break → break info\n- GET getActiveBreak no break → null\n\nINTEGRATION TESTS:\n- Add 10 min break → schedule delays 10 min\n- End early at 6 min → schedule recovers 4 min\n- Add break mid-competition → all future times shift\n\nEDGE CASES:\n- End break before it starts\n- Add break during break\n- 60+ minute emergency break (max limit?)\n- End break after full duration elapsed",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 18,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T07:21:56.521Z"
      },
      {
        "id": "19",
        "title": "Backend API - Live Routine Control",
        "description": "Add tRPC endpoints for CD routine control: setCurrentRoutine, advanceRoutine, previousRoutine, getLiveState",
        "details": "setCurrentRoutine mutation:\n- Input: competitionId, routineId\n- Updates live_competition_state.current_routine_id\n- Updates current_routine_index\n- Returns updated state\n\nadvanceRoutine mutation:\n- Input: competitionId\n- Moves to next routine in order\n- Marks previous as completed (calculated_score check)\n- Returns new current routine\n\npreviousRoutine mutation:\n- Input: competitionId\n- Moves back one routine\n- Returns new current routine\n\ngetLiveState query:\n- Input: competitionId\n- Returns: current routine, status, delay, break info, progress\n- Used by all views for sync",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Live Routine Control",
            "description": "Comprehensive tests for routine control endpoints",
            "details": "UNIT TESTS:\n- setCurrentRoutine updates current_routine_id\n- setCurrentRoutine updates current_routine_index\n- advanceRoutine moves to next in order\n- advanceRoutine marks previous as completed\n- previousRoutine moves back one\n- getLiveState returns full state object\n\nAPI TESTS:\n- POST setCurrentRoutine → 200, state updated\n- POST advanceRoutine → 200, next routine\n- POST advanceRoutine at last routine → error or wrap\n- POST previousRoutine → 200, previous routine\n- POST previousRoutine at first → error or stay\n- GET getLiveState → full competition state\n\nINTEGRATION TESTS:\n- Start competition → setCurrentRoutine(first) → getLiveState\n- Advance through 5 routines → verify each current\n- Go back 2 routines → verify index correct\n- All devices call getLiveState → same result\n\nEDGE CASES:\n- Set current to scratched routine\n- Advance when current has no scores\n- Previous at routine 1\n- Advance at last routine",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 19,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T07:09:01.797Z"
      },
      {
        "id": "20",
        "title": "Backend API - Routine Reorder & Scratch",
        "description": "Add tRPC endpoints for CD routine management: reorderRoutine, scratchRoutine, moveRoutineToDay",
        "details": "reorderRoutine mutation:\n- Input: competitionId, routineId, newPosition (index)\n- Updates running_order for affected routines\n- Entry number stays LOCKED (never changes)\n- Recalculates scheduled times\n- Returns updated lineup\n\nscratchRoutine mutation:\n- Input: routineId, reason (optional)\n- Sets status to 'scratched' or 'withdrawn'\n- Removes from active lineup\n- Entry number preserved (gap in sequence)\n- Returns confirmation\n\nmoveRoutineToDay mutation:\n- Input: routineId, targetDay (date)\n- Updates scheduled_day field\n- Recalculates running_order for both days\n- Returns updated lineup for both days",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Routine Reorder & Scratch",
            "description": "Comprehensive tests for routine management endpoints",
            "details": "UNIT TESTS:\n- reorderRoutine updates running_order\n- reorderRoutine keeps entry_number unchanged\n- reorderRoutine recalculates times\n- scratchRoutine sets status to withdrawn\n- scratchRoutine removes from active lineup\n- moveRoutineToDay updates scheduled_day\n\nAPI TESTS:\n- POST reorderRoutine move 5→2 → 200\n- POST reorderRoutine verify entry numbers same\n- POST scratchRoutine → 200, status=withdrawn\n- POST scratchRoutine with reason → 200, reason saved\n- POST moveRoutineToDay → 200, day changed\n\nINTEGRATION TESTS:\n- Reorder: Entry #105 moved from pos 5 to pos 2\n  - Verify entry number still 105\n  - Verify time slots recalculated\n  - Verify other routines shifted\n- Scratch: Mark routine withdrawn\n  - Verify gap in entry numbers\n  - Verify removed from lineup\n- Move day: Sat routine to Sun\n  - Verify both days' schedules updated\n\nEDGE CASES:\n- Reorder completed routine (block?)\n- Reorder to same position (no-op)\n- Scratch current routine\n- Move routine to past day",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 20,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T07:31:59.545Z"
      },
      {
        "id": "21",
        "title": "Backend API - Score Edit with Audit Log",
        "description": "Add tRPC endpoint for CD to edit submitted scores: editScore, getScoreHistory",
        "details": "editScore mutation:\n- Input: scoreId, newValue (60-100), reason (optional)\n- Verify CD role authorization\n- Create score_audit_log entry (old_value, new_value, changed_by)\n- Update scores.total_score\n- Recalculate calculated_score for the entry\n- Return updated score + audit entry\n\ngetScoreHistory query:\n- Input: scoreId OR routineId\n- Returns all audit log entries for score(s)\n- Shows who changed, when, old→new values\n- CD only access",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Score Edit with Audit",
            "description": "Comprehensive tests for CD score editing",
            "details": "UNIT TESTS:\n- editScore updates total_score value\n- editScore creates audit log entry\n- editScore stores old_value, new_value, changed_by\n- editScore recalculates entry's calculated_score\n- getScoreHistory returns all audit entries\n- getScoreHistory ordered by changed_at desc\n\nAPI TESTS:\n- POST editScore as CD → 200, score updated\n- POST editScore as Judge → 403 (forbidden)\n- POST editScore with reason → 200, reason saved\n- GET getScoreHistory(scoreId) → list of changes\n- GET getScoreHistory(routineId) → all scores' history\n\nAUTHORIZATION TESTS:\n- Only CD role can call editScore\n- Judge cannot edit own score after submit\n- Judge cannot edit other judge's score\n- SA can edit any score\n\nINTEGRATION TESTS:\n- Judge submits 75 → CD edits to 82 → audit shows 75→82\n- CD edits same score 3 times → full history preserved\n- Edit score → recalculate → award level changes\n\nEDGE CASES:\n- Edit to same value (should still log?)\n- Edit score to out of range (60-100)\n- Edit score on scratched routine\n- Edit during offline sync",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 21,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T07:41:27.058Z"
      },
      {
        "id": "22",
        "title": "Backend API - MP3 File Management",
        "description": "Add tRPC endpoints for MP3 handling: getMP3Url, uploadMP3, getMP3Status, bulkGetMP3Urls",
        "details": "getMP3Url query:\n- Input: routineId\n- Returns signed Supabase bucket URL (1 hour expiry)\n- Returns mp3_duration_seconds from entry\n- Caches URL for repeated requests\n\nuploadMP3 mutation:\n- Input: routineId, file (multipart)\n- Uploads to Supabase bucket\n- Extracts duration from file\n- Updates competition_entries.mp3_url, mp3_duration_seconds\n- Naming: {entryNumber}_{title}_{studioCode}.mp3\n- Returns signed URL\n\ngetMP3Status query:\n- Input: competitionId\n- Returns count: total, uploaded, missing\n- List of routines missing MP3s\n\nbulkGetMP3Urls query:\n- Input: competitionId\n- Returns all MP3 URLs for offline download\n- Used by Backstage for bulk prefetch",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - MP3 File Management",
            "description": "Comprehensive tests for MP3 endpoints",
            "details": "UNIT TESTS:\n- getMP3Url returns signed URL with 1hr expiry\n- getMP3Url returns duration_seconds\n- uploadMP3 stores file in Supabase bucket\n- uploadMP3 extracts duration from file\n- uploadMP3 names file correctly\n- getMP3Status counts total/uploaded/missing\n- bulkGetMP3Urls returns all URLs for competition\n\nAPI TESTS:\n- GET getMP3Url(routineId) → signed URL\n- GET getMP3Url(invalidId) → 404\n- POST uploadMP3 with file → 200, URL returned\n- POST uploadMP3 without file → 400\n- GET getMP3Status → counts object\n- GET bulkGetMP3Urls → array of URLs\n\nINTEGRATION TESTS:\n- Upload MP3 → getMP3Url → download works\n- Upload → duration saved → getLineup shows duration\n- Bulk download all URLs → all valid\n\nSTORAGE TESTS:\n- Upload 10MB MP3 (large file)\n- Upload 100KB MP3 (small file)\n- Upload 6000 files (capacity test)\n- Supabase bucket permissions correct\n\nEDGE CASES:\n- Upload non-MP3 file (should reject)\n- Upload corrupt MP3 (should detect?)\n- Re-upload same routine (overwrite?)\n- URL expires, request again",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 22,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T06:01:19.666Z"
      },
      {
        "id": "23",
        "title": "Backend API - Schedule Delay Calculator",
        "description": "Add tRPC endpoint for calculating schedule delay: getScheduleDelay, recalculateScheduleTimes",
        "details": "getScheduleDelay query:\n- Input: competitionId\n- Calculates: planned_time vs actual_time for current routine\n- Returns: delay_minutes (positive=behind, negative=ahead)\n- Factors in: completed routines, breaks taken, current time\n\nrecalculateScheduleTimes mutation:\n- Input: competitionId, startFromRoutineId (optional)\n- Recalculates all performance_time fields\n- Accounts for breaks in schedule_breaks\n- Uses mp3_duration_seconds for each routine\n- Returns updated schedule with new times",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Schedule Delay Calculator",
            "description": "Comprehensive tests for delay calculation",
            "details": "UNIT TESTS:\n- getScheduleDelay calculates planned vs actual\n- getScheduleDelay returns positive when behind\n- getScheduleDelay returns negative when ahead\n- recalculateScheduleTimes updates all times\n- recalculateScheduleTimes accounts for breaks\n- recalculateScheduleTimes uses mp3_duration\n\nAPI TESTS:\n- GET getScheduleDelay → delay_minutes\n- POST recalculateScheduleTimes → updated schedule\n- POST recalculateScheduleTimes(startFrom) → partial update\n\nCALCULATION TESTS:\n- 5 routines done on time → delay = 0\n- 5 routines + 10 min break → delay = 10\n- 5 routines done 5 min fast → delay = -5\n- Break ended early → delay reduced\n\nINTEGRATION TESTS:\n- Start competition → check delay = 0\n- Add break → check delay increased\n- Complete routines → delay stays consistent\n- All views see same delay value\n\nEDGE CASES:\n- Competition not started (delay = 0?)\n- All routines complete (delay final)\n- No mp3_duration set (default 3 min?)\n- Recalculate during active routine",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 23,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T09:09:38.476Z"
      },
      {
        "id": "24",
        "title": "Backend API - Judge Score Visibility Toggle",
        "description": "Add tRPC endpoint for CD to toggle judge score visibility: setScoreVisibility, getScoreVisibility",
        "details": "setScoreVisibility mutation:\n- Input: competitionId, visible (boolean)\n- Stores in live_competition_state or competition settings\n- When visible=true: judges see other judges' scores\n- When visible=false: judges only see their own score\n- Returns updated setting\n\ngetScoreVisibility query:\n- Input: competitionId\n- Returns current visibility setting\n- Used by Judge UI to show/hide other scores",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [
          "16"
        ],
        "priority": "low",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend API - Score Visibility Toggle",
            "description": "Comprehensive tests for score visibility",
            "details": "UNIT TESTS:\n- setScoreVisibility stores boolean setting\n- setScoreVisibility updates live_competition_state\n- getScoreVisibility returns current setting\n- Default visibility is false (judges can't see others)\n\nAPI TESTS:\n- POST setScoreVisibility(true) → 200\n- POST setScoreVisibility(false) → 200\n- GET getScoreVisibility → boolean\n- POST setScoreVisibility as Judge → 403 (CD only)\n\nINTEGRATION TESTS:\n- CD sets visible=true → Judge sees other scores\n- CD sets visible=false → Judge sees only own\n- Toggle mid-competition → immediate effect\n\nFRONTEND INTEGRATION:\n- Judge UI checks visibility on load\n- Judge UI hides/shows other scores section\n- Score updates respect visibility setting\n\nEDGE CASES:\n- Visibility not set (default false)\n- Change visibility during scoring\n- Multiple panels (different competitions)",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 24,
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": "25",
        "title": "Backend Fix - Update Score Range to 60-100",
        "description": "Fix submitScore validation from 0-10 to 60-100 range per spec",
        "details": "File: src/server/routers/liveCompetition.ts\nLine 189: Change from:\n  score: z.number().min(0).max(10),\nTo:\n  score: z.number().min(60).max(100),\n\nAlso verify calculateScore award level thresholds match 60-100 scale.\n\nCurrent thresholds (lines 432-438) appear correct:\n- platinum: [95, 100]\n- high_gold: [90, 94.9]\n- gold: [85, 89.9]\n- silver: [80, 84.9]\n- bronze: [70, 79.9]\n\nTest: Submit scores at boundaries (60, 70, 80, 85, 90, 95, 100)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "TEST: Backend Fix - Score Range 60-100",
            "description": "Comprehensive tests for score range fix",
            "details": "VALIDATION TESTS:\n- submitScore(60) → 200 (boundary min)\n- submitScore(100) → 200 (boundary max)\n- submitScore(80) → 200 (middle)\n- submitScore(59) → 400 (below min)\n- submitScore(101) → 400 (above max)\n- submitScore(59.9) → 400 (just below)\n- submitScore(100.1) → 400 (just above)\n\nAWARD LEVEL TESTS (after fix):\n- Score 95-100 → platinum\n- Score 90-94.9 → high_gold\n- Score 85-89.9 → gold\n- Score 80-84.9 → silver\n- Score 70-79.9 → bronze\n- Score 60-69.9 → participation\n\nBOUNDARY TESTS:\n- Score exactly 70 → bronze (not participation)\n- Score exactly 80 → silver (not bronze)\n- Score exactly 85 → gold (not silver)\n- Score exactly 90 → high_gold (not gold)\n- Score exactly 95 → platinum (not high_gold)\n\nREGRESSION TESTS:\n- Existing scores (if any 0-10) don't break\n- getStandings works with new range\n- calculateScore works with new range\n\nDECIMAL TESTS:\n- submitScore(85.5) → accepted\n- submitScore(89.99) → gold (not high_gold)\n- Display rounds appropriately",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 25,
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "SPEC UPDATE: Score validation 00.00-99.99 XX.XX format",
            "description": "Per client feedback: Change validation from min(60).max(100) to min(0).max(99.99) with regex for XX.XX format (two decimals required). Adjudication levels are tenant-configurable via competition_settings.adjudication_levels JSONB.",
            "details": "",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 25,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T06:05:26.182Z"
      },
      {
        "id": "26",
        "title": "Title Division Scoring System",
        "description": "When routine is Title Division, judges enter main score (XX.XX) PLUS 5 breakdown scores (whole numbers, 20 points each): Technique + 4 TBD categories. Create UI and backend support.",
        "details": "Per client (Selena) feedback:\\n- Title Division routines need 5 additional breakdown scores\\n- Technique (20 points max) + 4 other categories (TBD from client)\\n- Breakdown scores CAN be whole numbers (no decimal required)\\n- Main score still requires XX.XX format\\n- UI: Show regular score field, then 'Title Breakdown' section with 5 fields\\n- Database: Add title_breakdown table or columns to scores table",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "7"
        ],
        "priority": "high",
        "subtasks": [],
        "updatedAt": "2025-12-12T07:46:54.889Z"
      },
      {
        "id": "27",
        "title": "Edge Case Alert System - Score Bumping Detection",
        "description": "Alert Tabulator when one judge's small difference (e.g., 0.01) causes routine to bump DOWN adjudication level. Triggers human conversation, NOT automation.",
        "details": "Per client (Selena) feedback:\\n- Example: Two judges 99.00, one judge 98.99 → bumps down a level\\n- System displays visual alert to Tabulator\\n- Tabulator talks to judge (human conversation)\\n- Judge re-enters corrected score on their iPad\\n- Tabulator does NOT edit judge marks directly\\n- Rationale: Studios receive printouts showing all 3 scores, they will notice discrepancies\\n\\nAlgorithm needed:\\n1. After all 3 scores submitted, calculate average\\n2. Check if average is within threshold of level boundary\\n3. Identify if single score is causing the bump\\n4. Display alert with judge name, score diff, levels affected",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "4"
        ],
        "priority": "high",
        "subtasks": [],
        "updatedAt": "2025-12-12T07:53:51.174Z"
      },
      {
        "id": "28",
        "title": "Label Printing for Tabulator",
        "description": "Tabulator needs ability to print labels with routine scores: Routine number/name, Judge A/B/C scores, Average, Adjudication level.",
        "details": "Per client (Selena) feedback:\\n- Print labels with scores for each routine\\n- Label content: Routine #, Name, Judge A score, Judge B score, Judge C score, Average, Adjudication Level\\n- Browser print dialog or thermal printer support\\n- Batch print option for multiple routines\\n\\nTBD: Label size, template layout, printer requirements",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "4"
        ],
        "priority": "medium",
        "subtasks": [],
        "updatedAt": "2025-12-12T09:16:55.725Z"
      },
      {
        "id": "29",
        "title": "Backstage TV Display Mode",
        "description": "TV-optimized view for backstage waiting area showing time remaining in large format, current routine, and next up.",
        "details": "Per client (Selena) feedback:\\n- 'Really cool' to put on TV screen in backstage area\\n- Shows time remaining in routine while dancers wait\\n- Helpful because 'you can't always tell how much is left in the song'\\n- Large, readable display optimized for viewing from distance\\n\\nUI:\\n- Large countdown timer (central)\\n- Current routine name and entry number\\n- Studio name\\n- 'UP NEXT' routine preview\\n- No controls (read-only display)",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "1"
        ],
        "priority": "medium",
        "subtasks": [],
        "updatedAt": "2025-12-12T09:28:40.260Z"
      },
      {
        "id": "30",
        "title": "Music Upload System - Studio Portal",
        "description": "Studios upload MP3s via routines dashboard. Shows upload status, big green checkmark when complete. Competition director sees missing music report.",
        "details": "Per client (Selena) feedback:\\n\\nStudio Side:\\n- Upload MP3 directly from routine detail page\\n- Progress indicator during upload\\n- Big green checkmark when ALL music uploaded for studio\\n- File naming: [EntryNumber]_[RoutineTitle]_[StudioCode].mp3\\n\\nCompetition Director Side:\\n- Missing music report showing which studios missing music\\n- List specific entries without MP3s\\n- Count format: 'Studio A is missing music from 3 entries'\\n- Click to email studio about missing music\\n\\nWorkflow:\\n1. Week before: System generates missing music report\\n2. CD sends reminder to studios\\n3. Studios upload remaining files\\n4. Day before: All MP3s downloaded to backstage",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "22"
        ],
        "priority": "high",
        "subtasks": [],
        "updatedAt": "2025-12-12T07:58:04.934Z"
      },
      {
        "id": "31",
        "title": "Post-Competition Studio Score Printouts",
        "description": "Generate PDF printouts for studios showing all their routines with Judge A/B/C scores, average, and adjudication level. Distributed at end of competition weekend.",
        "details": "Per client (Selena) feedback:\\n- Studios receive printouts of all their scores at end of weekend\\n- Shows Judge A, Judge B, Judge C scores for each routine\\n- Shows calculated average\\n- Shows adjudication level achieved\\n- They will see discrepancies (hence edge case alert system)\\n\\nFormat:\\n- PDF generation per studio\\n- All routines for that studio\\n- Batch generate all studios at once\\n- Print or email option",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "updatedAt": "2025-12-12T08:37:33.357Z"
      },
      {
        "id": "32",
        "title": "SPEC UPDATE: Score Format XX.XX (replaces 60-100)",
        "description": "Per client feedback: Score format is XX.XX (two decimals ALWAYS required), range 00.00-99.99. This supersedes all references to 60-100 in tasks 7, 12, 25. Input: BOTH slider AND manual typing.",
        "details": "CLIENT REQUIREMENT (Selena):\\n- Format: XX.XX (number + decimal + two decimal places)\\n- Range: 00.00 to 99.99\\n- Valid: 89.06, 42.67, 98.90, 75.00\\n- Invalid: 69, 72, 43, 86.6, 89.3\\n- Input: Manual typing (faster) OR slider\\n\\nTASKS TO UPDATE:\\n- Task 7: Judge scoring UI - change slider range\\n- Task 12: Backend validation - change from min(60).max(100)\\n- Task 25: Backend fix - update Zod schema\\n\\nZod validation:\\nz.string().regex(/^\\\\d{1,2}\\\\.\\\\d{2}$/, 'Score must be in XX.XX format')",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "updatedAt": "2025-12-12T04:48:18.478Z"
      },
      {
        "id": "33",
        "title": "SPEC UPDATE: Terminology - Tabulator not CD",
        "description": "Per client feedback: Use 'Tabulator' instead of 'Competition Director' or 'CD' in live views. Also: exactly 3 judges (A, B, C), ONLY Tabulator can move routines.",
        "details": "CLIENT TERMINOLOGY:\\n- 'Tabulator' (not CD) for live competition control\\n- Judge A, Judge B, Judge C (exactly 3)\\n- 'Adjudication' (not 'Awards Ceremony')\\n\\nPERMISSIONS:\\n- ONLY Tabulator can move/reorder routines\\n- Judges and Backstage cannot move anything\\n\\nUI LABELS TO UPDATE:\\n- 'CD Control Panel' → 'Tabulator Control Panel'\\n- References in help text and tooltips",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "low",
        "subtasks": [],
        "updatedAt": "2025-12-12T04:48:18.642Z"
      },
      {
        "id": "34",
        "title": "Database Schema: Title Breakdown + Judge Position",
        "description": "Add title_score_breakdown table for 5 breakdown categories, and judge_position field (A/B/C) to judges table.",
        "details": "NEW TABLE - title_score_breakdown:\\n- id UUID PRIMARY KEY\\n- score_id UUID REFERENCES scores(id)\\n- technique INT (0-20)\\n- category2 INT (0-20) -- TBD name from client\\n- category3 INT (0-20)\\n- category4 INT (0-20)\\n- category5 INT (0-20)\\n- created_at TIMESTAMP\\n\\nADD TO judges TABLE:\\n- judge_position ENUM('A', 'B', 'C')\\n\\nThis determines display order in Tabulator view:\\n- Judge A score | Judge B score | Judge C score | Average",
        "testStrategy": "",
        "status": "done",
        "dependencies": [
          "16"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Add adjudication_levels JSONB to competition_settings",
            "description": "Adjudication levels are TENANT-CONFIGURABLE. Add competition_settings.adjudication_levels JSONB column with structure: {levels: [{name, min, max, color}], edgeCaseThreshold: 0.1}. Each tenant defines their own level names and score ranges.",
            "details": "",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 34,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-12T07:58:39.640Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2025-12-12T09:42:52.751Z",
      "taskCount": 34,
      "completedCount": 32,
      "tags": [
        "master"
      ]
    }
  }
}